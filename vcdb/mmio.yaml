---
name: VC_MMIO
offset: 0x7e000000
bare: yes
blocks:
  0x2000:
    name: ALT_MMC
    brief: Alternate interface to MMC/SD cards
    size: 0x1000
    desc: >
      This is used by bootcode.bin to load the next executable from the SD card.
    registers:
      0x0:
        name: CMD
        brief: MMC Command
        desc: TBD
        bits:
          15:
            name: EXECUTING
            access: rw
            desc: >
              Set this to 1 to when executing a command, it will reset itself to
              0 when the command has finished executing.
          11:
            access: ?w
            desc: >
              Set this to zero when executing TRANSFER_STOP or one when
              executing READ_MULTIPLE_BLOCKS.
          7-0:
            name: COMMAND
            desc: >
              The command according to the MMC spec.
      0x4:
        name: CMD_ARG
        brief: MMC Command Argument
        desc: >
            The command argument should be written here before the command is
            written to 0x0.
      0x20:
        name: STATUS
        bits:
          31-1:
            desc: Bits 7:5 and 3 are sometimes returned from a function
          0:
            name: FIFO_STATUS
            access: r
            desc: Set when there is data in the FIFO (DATA register).
      0x40:
        name: DATA
        offset: 0x40
        desc: >
          Data from the MMC card can be read from this FIFO 4 bytes at a time.

  0x7000:
    name: DMA
    brief: DMA Controller (Channels 0-14)
    size: 0x1000
    arrays:
      0x0:
        name: CHAN_${n}
        length: 15
        stride: 0x100
        expand_doc: no
        block: &DMA_CHANNEL
          brief: DMA channel register set
          size: 0x100
          desc: >
            Registers to control operation of one single DMA channel.
          registers:
            0x0:
              name: CS
              brief: Control and Status
              access: rw
              bits:
                31:
                  name: RESET
                  access: w
                30:
                  name: ABORT
                  access: w
                29:
                  name: DISDEBUG
                  access: rw
                28:
                  name: WAIT
                  access: rw
                23-20:
                  name: PANIC_PRIO
                  access: rw
                19-16:
                  name: PRIORITY
                  access: rw
                8:
                  name: ERROR
                  access: r
                6:
                  name: WAIT_STATUS
                  access: r
                5:
                  name: DREQ_STOPS_DMA
                  access: r
                4:
                  name: PAUSED
                  access: r
                3:
                  name: DREQ
                  access: r
                2:
                  name: INT
                  access: rw
                1:
                  name: END
                  access: rw
                0:
                  name: ACTIVE
                  access: rw
